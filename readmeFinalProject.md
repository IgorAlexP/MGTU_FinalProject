#  Пояснительная записка к проекту "Прогнозирование **Product ID** с использованием **RandomForestClassifier**"

### Введение
Проект посвящен разработке и применению модели машинного обучения для прогнозирования Product ID. В качестве модели используется алгоритм RandomForestClassifier из библиотеки scikit-learn. Проект включает в себя загрузку данных, их предварительную обработку, обучение модели, оценку ее точности, логирование с использованием MLFlow, восстановление модели и визуализацию результатов.

## Описание работы кода
1. Подготовка данных.

* Подключение к базе данных SQLite:
Создается подключение к базе данных SQLite с помощью библиотеки SQLAlchemy.
![подключение к БД](/images/scr1.jpg)

2. Загрузка данных.

* Исходные данные загружаются из файла Excel и добавляется префикс к именам столбцов.
![загрузка](/images/scr2.jpg)

3. Сохранение данных в стейджинговой таблице.

* Данные сохраняются в стейджинговой таблице в базе данных.
![Сохранение данных в стейджинговой таблице](/images/scr3.jpg)

4. Обработка данных
* Чтение данных из таблицы:

Данные считываются из стейджинговой таблицы в базе данных.
![чтение данных](/images/scr4.jpg)

5. Разбиение на обучающий и тестовый наборы:
* Данные разбиваются на обучающий и тестовый наборы, и выбираются первые 10 строк для обучения.

![разбиение](/images/scr5.jpg)

6. Исключение столбцов с типом 'object' и заполнение пропущенных значений:
* Из обучающего набора исключаются столбцы с типом 'object', и пропущенные значения заполняются стратегией 'mean'.

![исключение](/images/scr6.jpg)

### Обучение и оценка модели
1. Инициализация и обучение модели RandomForestClassifier:
* Инициализируется модель RandomForestClassifier и обучается на обучающем наборе данных.

![обучение модели](/images/scr7.jpg)

2. Предсказание на тестовых данных и оценка метрик:
* Модель предсказывает значения на тестовых данных, и вычисляется точность с использованием метрики accuracy_score.

![предсказание](/images/scr8.jpg)

### Логирование и восстановление модели
1. Логирование модели в MLFlow:
* Обученная модель сохраняется в MLFlow для последующего восстановления.

![логирование](/images/scr9.jpg)

2. Восстановление модели и предсказание на тестовых данных из базы данных:
* Восстанавливается модель из MLFlow, предсказываются значения на тестовых данных из базы данных и результаты записываются в новую таблицу.

![восстановление](/images/scr10.jpg)

### Визуализация результатов
1. Визуализация распределения целевой переменной и фактических vs. предсказанных значений:
* Распределение целевой переменной в тестовых данных и сравнение фактических и предсказанных значений.

![визуализация](/images/scr11.jpg)
### Вывод
Этот код обеспечивает полный цикл работы с данными, обучения модели, сохранения и загрузки модели с использованием MLflow, а также визуализации результатов с помощью Seaborn и Matplotlib. При необходимости, в дальнейшем, можно использовать результаты предсказаний для принятия решений или дальнейшего анализа.


![graf](/images/graf1.png)

![graf](/images/graf2.png)

![graf](/images/graf3.png)